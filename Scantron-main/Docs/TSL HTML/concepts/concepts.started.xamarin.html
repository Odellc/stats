<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Getting Started with ASCII Protocol in Xamarin | TechnologySolutions.Rfid.AsciiProtocol </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Getting Started with ASCII Protocol in Xamarin | TechnologySolutions.Rfid.AsciiProtocol ">
    <meta name="generator" content="docfx 2.43.3.0">
    
    <link rel="shortcut icon" href="../resources/ico/favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc">
    <meta property="docfx:tocrel" content="toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../resources/svg/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../index.html" title="Home">Home</a>
                      </li>
                      <li>
                          <a href="../protocol/protocol.introduction.html" title="ASCII 2 Protocol">ASCII 2 Protocol</a>
                      </li>
                      <li>
                          <a href="../api/TechnologySolutions.Rfid.html" title=".NET API">.NET API</a>
                      </li>
                      <li>
                          <a href="../concepts/concepts.api.overview.html" title="Concepts">Concepts</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">API</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="concepts.api.overview.html" title="API Theory Of Operation" class="">API Theory Of Operation</a>
                          </li>
                          <li class="">
                            <a href="concepts.api.inventorytagaccess.html" title="API Inventory and Tag Access" class="">API Inventory and Tag Access</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Getting Started</a>
                        
                        <ul class="nav level2">
                          <li class="active">
                            <a href="concepts.started.xamarin.html" title="Xamarin" class="active">Xamarin</a>
                          </li>
                          <li class="">
                            <a href="concepts.started.dotnet.html" title=".NET" class="">.NET</a>
                          </li>
                          <li class="">
                            <a href="concepts.started.connect.html" title="Connecting" class="">Connecting</a>
                          </li>
                          <li class="">
                            <a href="concepts.started.command.html" title="Commanding" class="">Commanding</a>
                          </li>
                          <li class="">
                            <a href="concepts.started.asciicommander.html" title="AsciiCommander" class="">AsciiCommander</a>
                          </li>
                          <li class="">
                            <a href="concepts.started.operations.html" title="Reader Operations" class="">Reader Operations</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Miscellaneous</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="concepts.bluetoothpairing.html" title="Bluetooth Pairing" class="">Bluetooth Pairing</a>
                          </li>
                          <li class="">
                            <a href="concepts.hostbarcode.html" title="Host Barcode" class="">Host Barcode</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Application Notes</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="concepts.bluetoothmodes.html" title="Comparison of Bluetooth modes" class="">Comparison of Bluetooth modes</a>
                          </li>
                          <li class="">
                            <a href="concepts.bluetoothhidmode.html" title="Bluetooth HID mode" class="">Bluetooth HID mode</a>
                          </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-12">
            <article class="content wrap" id="_content" data-uid="concepts.started.xamarin">
<h1 id="getting-started---xamarin">Getting Started - Xamarin</h1>

<h2 id="overview">Overview</h2>
<ul>
<li>Create a new Xamarin project</li>
<li>Add the <a href="https://www.nuget.org/packages/Tsl.AsciiProtocol.Std/">Tsl.AsciiProtocol.Std nuget package</a></li>
<li>Set platform specific <a href="#platform-specifics">permissions</a> (see below)</li>
<li>Determine which option to use to connect to the readers
<ul>
<li>Using the <strong>ASCII Transports API</strong></li>
<li>Using the <strong>Legacy reader connection manager</strong></li>
</ul>
</li>
<li>Determine which option to use to communicate with the readers
<ul>
<li>Using <strong>Reader Operations</strong></li>
<li>Using the <strong>ASCII Protocol</strong></li>
</ul>
</li>
</ul>
<p>Create a normal Xamarin Project of your choice and reference the <a href="https://www.nuget.org/packages/Tsl.AsciiProtocol.Std/">Tsl.AsciiProtocol.Std nuget package</a>.
You need to add the nuget package to each project in your solution, the common .NET Standard code and the platform specific code projects.
We currently support Android, iOS, UWP, and WPF</p>
<h2 id="platform-specifics">Platform Specifics</h2>
<h3 id="android">Android</h3>
<p>You need permissions for Bluetooth. Use one of the following options:</p>
<ul>
<li>Open the AndroidManifest.xml and add the following permissions:</li>
</ul>
<pre><code>   &lt;uses-permission android:name=”android.permission.BLUETOOTH” /&gt;
   &lt;uses-permission android:name=”android.permission.BLUETOOTH_ADMIN” /&gt;
</code></pre>
<ul>
<li>Open the Android AssemblyInfo.cs and add:</li>
</ul>
<pre><code>   [assembly: UsesPermission(Android.Manifest.Permission.Bluetooth)]
   [assembly: UsesPermission(Android.Manifest.Permission.BluetoothAdmin)]
</code></pre>
<ul>
<li>Open the Android project Properties -&gt; Android Manifest and ensure the BLUETOOTH and BLUETOOTH_ADMIN options are ticked.</li>
</ul>
<p>If you want your App to be launched when an ePop-Loq device is attached, or when a USB OTG connection is made, then add the following to your launch Activity (e.g. MainActivity.cs)</p>
<pre><code>    [IntentFilter(new[] { UsbManager.ActionUsbDeviceAttached, UsbManager.ActionUsbDeviceDetached })]
    [MetaData(UsbManager.ActionUsbDeviceAttached, Resource = &quot;@xml/device_filter&quot;)]
    [MetaData(UsbManager.ActionUsbDeviceDetached, Resource = &quot;@xml/device_filter&quot;)]
</code></pre>
<p>Be aware that, when an ePop-Loq/USB OTG device connects, it will cause a new Activity to be created unless you specify Single Task mode in the Activity annotation, for example:</p>
<pre><code>    [Activity(Label = &quot;My Great App&quot;, Icon = &quot;@drawable/ic_tab&quot;, Theme = &quot;@style/MainTheme&quot;,
        MainLauncher = true,
        ConfigurationChanges = ConfigChanges.ScreenSize, ScreenOrientation = ScreenOrientation.Portrait, 
        LaunchMode = LaunchMode.SingleTask
        )]

</code></pre>
<p>For the <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.Extensions.AsciiTransportsManager.html">AsciiTransportsManager</a> to operate correctly on Android it need to be informed as your Activity pauses and resumes.
To achieve this we have provided a simple interface <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.Extensions.IAndroidLifecycle.html">IAndroidLifecycle</a>.</p>
<pre><code class="lang-csharp" name="MainActivity">using System;

using Android.App;
using Android.Content.PM;
using Android.Runtime;
using Android.Views;
using Android.Widget;
using Android.OS;
using TechnologySolutions.Rfid.AsciiProtocol.Extensions;
using TechnologySolutions.Rfid.AsciiProtocol.Transports;

namespace Sdk.Example.Droid
{
    [Activity(Label = &quot;Sdk.Example&quot;, Icon = &quot;@mipmap/icon&quot;, Theme = &quot;@style/MainTheme&quot;, MainLauncher = true, ConfigurationChanges = ConfigChanges.ScreenSize | ConfigChanges.Orientation)]
    public class MainActivity : global::Xamarin.Forms.Platform.Android.FormsAppCompatActivity
    {
        /// &lt;summary&gt;
        /// Holds a reference to be notified when the Activity pauses and resumes
        /// &lt;/summary&gt;
        private IAndroidLifecycle lifecycle;

        protected override void OnCreate(Bundle savedInstanceState)
        {
            TabLayoutResource = Resource.Layout.Tabbar;
            ToolbarResource = Resource.Layout.Toolbar;

            base.OnCreate(savedInstanceState);
            global::Xamarin.Forms.Forms.Init(this, savedInstanceState);
            LoadApplication(new App());
        }

        protected override void OnResume()
        {
            base.OnResume();

            // On first resume lifecycle has not been set. Subsequent calls it will already but initialised.
            if (this.lifecycle == null)
            {
                // AsciiTransportsManager should be a singleton in your applcation.
                // Bait and switch will mean that you can Instantiate it in your .Net Standard portable code 
                // but it will be the Android platform specific version when referenced here.

                // Get a reference to the AsciiTransportsManager singleton with your DI 
                // or global reference of choice. Here we use our Locator class
                AsciiTransportsManager transportsManager;
                transportsManager = Locator.Locate&lt;IAsciiTransportsManager&gt;() as AsciiTransportsManager;
                this.lifecycle = transportsManager;

                // Other components that require lifecycle calls can be registered with the AsciiTransportsManager
                // Here the HostBarcodeHandler is registered.
                HostBarcodeHandler hostBarcode = Locator.Locate&lt;IHostBarcodeHandler&gt;() as HostBarcodeHandler;
                transportsManager.RegisterLifecycle(hostBarcode);
            }

            // Now we have the lifecycle setup, call OnResume passing the activity context each time we resume 
            this.lifecycle.OnResume(this);
        }

        protected override void OnPause()
        {
            base.OnPause();

            // Call OnPause to notify each time we pause
            this.lifecycle.OnPause();
        }
    }
}
</code></pre>
<p>To enable the <em>Honeywell</em> terminal Barcode Scanner support Open the Android AssemblyInfo.cs and add:</p>
<pre><code>   [assembly: UsesPermission(&quot;com.honeywell.decode.permission.DECODE&quot;)]
</code></pre>
<h3 id="ios">iOS</h3>
<p>You need to add com.uk.tsl. to the pList. Open the info.plist using “Open with” and the “XML (Text) Editor” - add the following to the <code>&lt;dict&gt;</code> element:</p>
<pre><code>    &lt;key&gt;UISupportedExternalAccessoryProtocols&lt;/key&gt;
    &lt;array&gt;
    &lt;string&gt;com.uk.tsl.rfid&lt;/string&gt;
    &lt;/array&gt;
</code></pre>
<h3 id="uwp">UWP</h3>
<p>You need to add USB and Bluetooth device capabilities to the appx manifest</p>
<p>Open the Package.appxmanifest using the View Code option to edit the raw XML and ensure the capabilities
section contains the following:</p>
<pre><code>    &lt;Capabilities&gt;         
        &lt;DeviceCapability Name=&quot;bluetooth.rfcomm&quot; /&gt;
        &lt;DeviceCapability Name=&quot;serialcommunication&quot;&gt;
          &lt;Device Id=&quot;any&quot;&gt;
            &lt;Function Type=&quot;name:serialPort&quot; /&gt;
          &lt;/Device&gt;
        &lt;/DeviceCapability&gt;
    &lt;/Capabilities&gt;
</code></pre>
<h3 id="wpf">WPF</h3>
<p>There are no additional permissions to configure.
To setup a Xamarin Forms project that works with WPF follow the guide below:
<a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/platform/other/wpf">https://docs.microsoft.com/en-us/xamarin/xamarin-forms/platform/other/wpf</a></p>
</article>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright © 2011 - 2019 Technology Solutions UK Ltd
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
