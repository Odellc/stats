<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Getting Started - AsciiCommander | TechnologySolutions.Rfid.AsciiProtocol </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Getting Started - AsciiCommander | TechnologySolutions.Rfid.AsciiProtocol ">
    <meta name="generator" content="docfx 2.43.3.0">
    
    <link rel="shortcut icon" href="../resources/ico/favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc">
    <meta property="docfx:tocrel" content="toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../resources/svg/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../index.html" title="Home">Home</a>
                      </li>
                      <li>
                          <a href="../protocol/protocol.introduction.html" title="ASCII 2 Protocol">ASCII 2 Protocol</a>
                      </li>
                      <li>
                          <a href="../api/TechnologySolutions.Rfid.html" title=".NET API">.NET API</a>
                      </li>
                      <li>
                          <a href="../concepts/concepts.api.overview.html" title="Concepts">Concepts</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">API</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="concepts.api.overview.html" title="API Theory Of Operation" class="">API Theory Of Operation</a>
                          </li>
                          <li class="">
                            <a href="concepts.api.inventorytagaccess.html" title="API Inventory and Tag Access" class="">API Inventory and Tag Access</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Getting Started</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="concepts.started.xamarin.html" title="Xamarin" class="">Xamarin</a>
                          </li>
                          <li class="">
                            <a href="concepts.started.dotnet.html" title=".NET" class="">.NET</a>
                          </li>
                          <li class="">
                            <a href="concepts.started.connect.html" title="Connecting" class="">Connecting</a>
                          </li>
                          <li class="">
                            <a href="concepts.started.command.html" title="Commanding" class="">Commanding</a>
                          </li>
                          <li class="active">
                            <a href="concepts.started.asciicommander.html" title="AsciiCommander" class="active">AsciiCommander</a>
                          </li>
                          <li class="">
                            <a href="concepts.started.operations.html" title="Reader Operations" class="">Reader Operations</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Miscellaneous</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="concepts.bluetoothpairing.html" title="Bluetooth Pairing" class="">Bluetooth Pairing</a>
                          </li>
                          <li class="">
                            <a href="concepts.hostbarcode.html" title="Host Barcode" class="">Host Barcode</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Application Notes</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="concepts.bluetoothmodes.html" title="Comparison of Bluetooth modes" class="">Comparison of Bluetooth modes</a>
                          </li>
                          <li class="">
                            <a href="concepts.bluetoothhidmode.html" title="Bluetooth HID mode" class="">Bluetooth HID mode</a>
                          </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-12">
            <article class="content wrap" id="_content" data-uid="concepts.started.asciicommander">
<h1 id="getting-started---asciicommander">Getting Started - AsciiCommander</h1>

<h2 id="overview">Overview</h2>
<p>The <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.AsciiCommander.html">AsciiCommander</a> is the key class for sending
<a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.Commands.html">TechnologySolutions.Rfid.AsciiProtocol.Commands</a>. The theory of operation is covered in
<a class="xref" href="concepts.api.overview.html">API Overview</a>.</p>
<h2 id="responder-chain">Responder Chain</h2>
<p>Before an AsciiCommander can be used it need to be configured. It has a
<a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.AsciiCommandExecutorBase.html#TechnologySolutions_Rfid_AsciiProtocol_AsciiCommandExecutorBase_ResponderChain">ResponderChain</a> that holds
one or more <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.IAsciiCommandResponder.html">IAsciiCommandResponder</a>. Each
<a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.Commands.AsciiCommandBase.html">AsciiCommandBase</a> has its own
<a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.Commands.AsciiCommandBase.html#TechnologySolutions_Rfid_AsciiProtocol_Commands_AsciiCommandBase_Responder">Responder</a>. This responder
can be added to the responder chain to capture responses for that type of command.</p>
<p>Typically a responder chain is setup as follows:</p>
<ul>
<li>A <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.LoggerResponder.html">LoggerResponder</a>, if used, should be added first. This logs all responses from the reader</li>
<li>A <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.SynchronousDispatchResponder.html">SynchronousDispatchResponder</a> is added next. The relays the responses back to commands being sent as <strong>send and receive</strong></li>
<li>Typically an <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.Commands.InventoryCommand.html">InventoryCommand</a> Responder is added to capture inventory responses from <strong>send only</strong> inventory commands or the trigger press</li>
<li>Typically a <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.Commands.BarcodeCommand.html">BarcodeCommand</a> Responder is added to capture barcode responses from <strong>send only</strong> barcode scans or trigger press</li>
<li>Typically a <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.SwitchAsynchronousResponder.html">SwitchAsynchronousResponder</a> is added to capture changes in switch state</li>
</ul>
<pre><code class="lang-csharp" name="AsciiCommander">        private AsciiCommander commander;
        private InventoryCommand inventory;
        private BarcodeCommand barcode;
        private SwitchAsynchronousResponder switchResponder;

        public AsciiCommanderExample()
        {
            this.inventory = new InventoryCommand();
            this.inventory.TransponderReceived += Inventory_TransponderReceived;
            this.barcode = new BarcodeCommand();
            this.barcode.BarcodeReceived += Barcode_BarcodeReceived;
            this.switchResponder = new SwitchAsynchronousResponder();
            this.switchResponder.SwitchStateChanged += SwitchResponder_SwitchStateChanged;

            this.commander = new AsciiCommander();
#if DEBUG
            commander.AddResponder(new LoggerResponder(Log)); // Can be useful for debugging not required
#endif
            // to forward the the response to a send and receive command back to the executing command
            // must be above other responders to prevent them stealing the response from the executing command
            commander.AddSynchronousResponder();

            // captures inventory responses from trigger press or send only inventory commands
            commander.AddResponder(inventory.Responder); 

            // captures barcode responses from trigger press of send only barcode commands
            commander.AddResponder(barcode.Responder);

            // captures changes in switch state when switch state reporting is enabled
            commander.AddResponder(switchResponder);
        }
</code></pre><h2 id="connecting-to-a-reader">Connecting to a Reader</h2>
<p>Once configured, the <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.AsciiCommander.html">AsciiCommander</a> needs to be connected to a Reader using an <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.IAsciiSerialTransport.html">IAsciiSerialTransport</a>. See <a class="xref" href="concepts.started.connect.html">Connecting to an ASCII 2 reader</a> for more details.
An <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.AsciiCommander.html">AsciiCommander</a> is connected to a
<a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.IAsciiSerialTransport.html">IAsciiSerialTransport</a> by setting the
<a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.AsciiCommander.html#TechnologySolutions_Rfid_AsciiProtocol_AsciiCommander_Transport">Transport</a> property or
using <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.AsciiCommander.html#TechnologySolutions_Rfid_AsciiProtocol_AsciiCommander_Connect_TechnologySolutions_Rfid_AsciiProtocol_IAsciiSerialTransport_">Connect(IAsciiSerialTransport)</a></p>
<pre><code class="lang-csharp" name="AsciiCommander">public void Connect(IAsciiSerialTransport transport)
{
    this.commander.Connect(transport);
    // ** OR **
    this.commander.Transport = transport;
}
</code></pre>
<p>A <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.AsciiCommander.html">AsciiCommander</a> is disconnected from a
<a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.IAsciiSerialTransport.html">IAsciiSerialTransport</a> by setting the
<a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.AsciiCommander.html#TechnologySolutions_Rfid_AsciiProtocol_AsciiCommander_Transport">Transport</a> property to null (Nothing in Visual Basic) or
using <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.AsciiCommander.html#TechnologySolutions_Rfid_AsciiProtocol_AsciiCommander_Disconnect">Disconnect()</a></p>
<pre><code class="lang-csharp" name="AsciiCommander">public void Disconnect()
{
    this.commander.Disconnect();
    // ** OR **
    this.commander.Transport = null;
}
</code></pre><h2 id="sending-commands">Sending Commands</h2>
<p>Commands can be sent to the reader using <strong>send and receive</strong> or <strong>send only</strong>.</p>
<h3 id="send-and-receive">Send and Receive</h3>
<p>With <strong>send and receive</strong> the response to the command is relayed back to the executing command via the
<a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.SynchronousDispatchResponder.html">SynchronousDispatchResponder</a>. It needs to be early in the responder
chain to prevent the more generic catch all responders capturing its response.</p>
<p>By passing the command's Responder to the ExecuteCommand method the response is relayed back to the executing
command and the method will not return until the command is executed or the <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.Commands.AsciiCommandBase.html#TechnologySolutions_Rfid_AsciiProtocol_Commands_AsciiCommandBase_MaxSynchronousWait">MaxSynchronousWait</a>
period is reached.</p>
<pre><code class="lang-csharp" name="AsciiCommander">public TCommand SendAndReceive&lt;TCommand&gt;(TCommand command) where TCommand: AsciiCommandBase
{
    this.commander.ExecuteCommand(command, command.Responder);
    if (!command.Response.IsSuccessful)
    {
        if (command.Response.ErrorCode == null)
        {
            // Command incomplete by command.MaxSynchronousWait
        }
        else
        {
            // command ended with ER: nnn rather than OK:
            var error = command.Response.ErrorCode.ParseParameterAs&lt;ErrorCode&gt;(); // e.g. ErrorCode.BatteryTooLow
        }
    }

    return command;
}
</code></pre><h3 id="send-only">Send Only</h3>
<p>With <strong>Send Only</strong> the command is sent to the reader and the method returns immediately. As the command's Responder
is not passed to ExecuteCommand the command line is sent to the reader but the response is expected to be captured by
another responder in the responder chain.</p>
<pre><code class="lang-csharp" name="AsciiCommander">public void SendOnly(IAsciiCommand command)
{
    this.commander.ExecuteCommand(command, null);
    // or this.commander.Send(command.CommandLine();)
}
</code></pre><h2 id="responding-to-changes-in-triggerstate">Responding to Changes in TriggerState</h2>
<p>To enable the reader to report changes to the trigger state you send a <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.Commands.SwitchActionCommand.html">SwitchActionCommand</a>
to enable asynchronous reporting of switch state.</p>
<pre><code class="lang-csharp" name="AsciiCommander">/// &lt;summary&gt;
/// Use the switch action command (.sa) to enable or disable asynchronous reporting of trigger press
/// &lt;/summary&gt;
/// &lt;param name=&quot;enabled&quot;&gt;&lt;/param&gt;
public void ChangeSwitchStateReporting(bool enabled)
{
    var command = new SwitchActionCommand() { AsynchronousReportingEnabled = enabled ? TriState.Yes : TriState.No };
    this.SendAndReceive(command);
    if (!command.Response.IsSuccessful)
    {
        if (command.Response.ErrorCode == null)
        {
            throw new Exception(&quot;failed to change switch state reporting no response received&quot;);
        }
        else
        {
            throw new Exception(&quot;failed to change switch state reporting reported error &quot; + command.Response.ErrorCode);
        }
    }
}
</code></pre>
<p>The <a class="xref" href="../api/TechnologySolutions.Rfid.AsciiProtocol.SwitchAsynchronousResponder.html">SwitchAsynchronousResponder</a> will then capture the changes in switch state</p>
<pre><code class="lang-csharp" name="AsciiCommander">private void SwitchResponder_SwitchStateChanged(object sender, SwitchStateEventArgs e)
{
    // SwitchState.Single / SwitchState.Double / SwitchState.Off
    System.Diagnostics.Debug.WriteLine(&quot;Switch: {0}&quot;, e.State); 
    this.SwitchStateChanged?.Invoke(this, e);
}
</code></pre></article>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright © 2011 - 2019 Technology Solutions UK Ltd
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
